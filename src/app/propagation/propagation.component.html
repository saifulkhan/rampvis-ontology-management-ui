<div class="main-content">
  <div class="container-fluid">
    <!--
      Card VIS search
    -->
    <div class="card">
      <div class="card-header card-header-primary card-header-icon">
        <div class="card-icon">
          <mat-icon>insert_chart</mat-icon>
        </div>
        <h4 class="card-title">Example Binding</h4>
      </div>

      <div class="card-body">
        <!-- VIS search form-->
        <form [formGroup]="ontoVisSearchFormGroup" class="vis-search">
          <mat-form-field>
            <input
              matInput
              type="text"
              [(ngModel)]="searchOntoVisQuery"
              formControlName="ontoVisSearchQuery"
              [matAutocomplete]="autoCompVis"
              placeholder="Search VIS functions"
              #input1
              (keydown.enter)="onClickSearchOntoVis()"
            />
            <mat-autocomplete #autoCompVis="matAutocomplete" (optionSelected)="optionSelected(input1)">
              <mat-option *ngFor="let d of suggestedOntoVis" [value]="d.function">
                <span [innerHTML]="d.function | highlight: highlightOntoVisSearchSuggestion"></span>
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>

          <button
            (click)="onClickSearchOntoVis()"
            [disabled]="!ontoVisSearchFormGroup.valid"
            class="btn btn-primary btn-round btn-fab float-right card-btn"
            type="submit"
          >
            <mat-icon>search</mat-icon>
          </button>
        </form>

        <!-- VIS search result table-->
        <mat-card *ngIf="ontoVisSearchResult?.length">
          <mat-card-header>
            <mat-card-title>VIS Function</mat-card-title>
            <mat-card-subtitle></mat-card-subtitle>
          </mat-card-header>
          <app-onto-vis-table-b [data]="ontoVisSearchResult"> </app-onto-vis-table-b>
        </mat-card>

        <!-- VIS example data table-->
        <mat-card *ngIf="exampleOntoData?.length">
          <mat-card-header>
            <mat-card-title>Data</mat-card-title>
            <mat-card-subtitle></mat-card-subtitle>
          </mat-card-header>
          <app-onto-data-ex-group
            [data]="exampleOntoData"
            (onChangeKeywords)="onUpdateKeywords($event)"
            (onChangeDataTypes)="onUpdateDataTypes($event)"
          >
          </app-onto-data-ex-group>
        </mat-card>

        <!-- VIS example page table-->
        <!--
        <mat-card *ngIf="exampleLinks?.length">
          <mat-card-header>
            <mat-card-title>Links</mat-card-title>
            <mat-card-subtitle></mat-card-subtitle>
          </mat-card-header>
          <app-onto-page-group [data]="exampleLinks"> </app-onto-page-group>
        </mat-card>
        -->
      </div>
    </div>

    <!--
      End- Card VIS search
    -->

    <!--
      Card search data
    -->

    <!-- <div class="card" *ngIf="exampleOntoData?.length"> -->
    <div class="card">
      <div class="card-header card-header-primary card-header-icon">
        <div class="card-icon">
          <mat-icon>search</mat-icon>
        </div>
        <h4 class="card-title">Search</h4>
      </div>
      <div class="card-body">
        <!--Data /group search form-->
        <div class="row">
          <div class="col-md-9">
            <mat-card>
              <mat-card-header>
                <mat-card-title>Search Criteria</mat-card-title>
                <mat-card-subtitle></mat-card-subtitle>
              </mat-card-header>

              <form>
                <mat-form-field>
                  <mat-label>Keywords (Must)</mat-label>
                  <mat-chip-list #keywordChipList1 aria-label="Must">
                    <mat-chip
                      *ngFor="let d of selectedKeywords1"
                      [selectable]="false"
                      [removable]="true"
                      (removed)="onClickRemoveKeyword1(d)"
                      [ngClass]="
                        selectedKeywords[d]?.state
                          ? 'keyword-chip-color-' + selectedKeywords[d]?.state
                          : 'keyword-chip-color'
                      "
                    >
                      {{ d }}
                      <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                    </mat-chip>
                    <input
                      placeholder="..."
                      #keywordInput1
                      [formControl]="keywordInputCtrl1"
                      [matAutocomplete]="autoKeyword1"
                      [matChipInputFor]="keywordChipList1"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="onEnterAddKeyword1($event)"
                    />
                  </mat-chip-list>
                  <mat-autocomplete #autoKeyword1="matAutocomplete" (optionSelected)="onInputKeyword1($event)">
                    <mat-option *ngFor="let d of filteredKeywords1$ | async" [value]="d">
                      {{ d }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>

                <mat-form-field>
                  <mat-label>Keywords (Should)</mat-label>
                  <mat-chip-list #keywordChipList2 aria-label="Should">
                    <mat-chip
                      *ngFor="let d of selectedKeywords2"
                      [selectable]="false"
                      [removable]="true"
                      (removed)="onClickRemoveKeyword2(d)"
                      [ngClass]="
                        selectedKeywords[d]?.state
                          ? 'keyword-chip-color-' + selectedKeywords[d]?.state
                          : 'keyword-chip-color'
                      "
                    >
                      {{ d }}
                      <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                    </mat-chip>
                    <input
                      placeholder="..."
                      #keywordInput2
                      [formControl]="keywordInputCtrl2"
                      [matAutocomplete]="autoKeyword2"
                      [matChipInputFor]="keywordChipList2"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="onEnterAddKeyword2($event)"
                    />
                  </mat-chip-list>
                  <mat-autocomplete #autoKeyword2="matAutocomplete" (optionSelected)="onInputKeyword2($event)">
                    <mat-option *ngFor="let d of filteredKeywords2$ | async" [value]="d">
                      {{ d }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>

                <mat-form-field>
                  <mat-label>Keywords (Must not)</mat-label>
                  <mat-chip-list #keywordChipList3 aria-label="Should">
                    <mat-chip
                      *ngFor="let d of selectedKeywords3"
                      [selectable]="false"
                      [removable]="true"
                      (removed)="onClickRemoveKeyword3(d)"
                      [ngClass]="
                        selectedKeywords[d]?.state
                          ? 'keyword-chip-color-' + selectedKeywords[d]?.state
                          : 'keyword-chip-color'
                      "
                    >
                      {{ d }}
                      <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                    </mat-chip>
                    <input
                      placeholder="..."
                      #keywordInput3
                      [formControl]="keywordInputCtrl3"
                      [matAutocomplete]="autoKeyword3"
                      [matChipInputFor]="keywordChipList3"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="onEnterAddKeyword3($event)"
                    />
                  </mat-chip-list>
                  <mat-autocomplete #autoKeyword3="matAutocomplete" (optionSelected)="onInputKeyword3($event)">
                    <mat-option *ngFor="let d of filteredKeywords3$ | async" [value]="d">
                      {{ d }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>

                <mat-form-field>
                  <mat-label>Data type (Filter)</mat-label>
                  <mat-chip-list #dataTypeChipList aria-label="Data type">
                    <mat-chip
                      *ngFor="let d; of selectedDataTypes_"
                      [selectable]="false"
                      [removable]="true"
                      (removed)="onClickRemoveDataType(d)"
                      [ngClass]="selectedDataTypes[d]?.state ? 'datatype-chip-color-1' : 'datatype-chip-color'"
                    >
                      {{ d }}
                      <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                    </mat-chip>
                    <input
                      placeholder="..."
                      #dataTypeInput
                      [formControl]="dataTypeInputCtrl"
                      [matAutocomplete]="autoDataType"
                      [matChipInputFor]="dataTypeChipList"
                      [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                      (matChipInputTokenEnd)="onEnterAddDataType($event)"
                    />
                  </mat-chip-list>
                  <mat-autocomplete #autoDataType="matAutocomplete" (optionSelected)="onInputDataType($event)">
                    <mat-option *ngFor="let d of filteredDataTypes$ | async" [value]="d">
                      {{ d }}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>

                <!-- <button
                  (click)="onClickSearchOntoData()"
                  [disabled]="!ontoDataSearchFormGroup.valid"
                  class="btn btn-primary float-right card-btn"
                  type="submit"
                >
                  <mat-icon>search</mat-icon>
                </button> -->
                <mat-card-actions align="end">
                  <button
                    mat-raised-button
                    class="btn btn-primary"
                    cdkFocusInitial
                    (click)="onClickSearchMatchingGroups()"
                    type="submit"
                  >
                    Search
                  </button>
                </mat-card-actions>

                <!--

                <div class="row">

                  <div class="col-md-2">
                    <ng-select
                      [items]="dataTypes"
                      [multiple]="true"
                      [closeOnSelect]="false"
                      [hideSelected]="true"
                      bindLabel="name"
                      placeholder="Filter Datatype "
                      formControlName="searchDataType"
                    >
                    </ng-select>
                  </div>

                  <mat-divider [vertical]="true" class="divider"></mat-divider>

                  <div class="col-md-5 align-centered-flex">
                    <ng-select
                      [items]="grpKeywords"
                      bindLabel="name"
                      bindValue="name"
                      groupBy="subGroup"
                      [multiple]="true"
                      [closeOnSelect]="false"
                      [selectableGroup]="true"
                      [selectableGroupAsModel]="false"
                      formControlName="searchKeywords1"
                      placeholder="AND Keywords"
                    >
                    <ng-template ng-optgroup-tmp let-item="item">
                      {{item.name}}
                    </ng-template>
                    <ng-template ng-option-tmp let-item="item">
                      {{item.name}}
                    </ng-template>
                    </ng-select>
                  </div>

                  <div class="col-md-5 align-centered-flex">
                    <ng-select
                      [items]="grpKeywords"
                      bindLabel="name"
                      bindValue="name"
                      groupBy="subGroup"
                      [multiple]="true"
                      [closeOnSelect]="false"
                      [selectableGroup]="true"
                      [selectableGroupAsModel]="false"
                      formControlName="searchKeywords2"
                      placeholder="OR Keywords"
                    >
                    <ng-template ng-optgroup-tmp let-item="item">
                      {{item.name}}
                    </ng-template>
                    <ng-template ng-option-tmp let-item="item">
                      {{item.name}}
                    </ng-template>
                    </ng-select>

                    <button
                      (click)="onClickSearchOntoData()"
                      [disabled]="!ontoDataSearchFormGroup.valid"
                      class="btn btn-primary btn-round btn-fab float-right card-btn"
                      type="submit"
                    >
                      <mat-icon>search</mat-icon>
                    </button>
                  </div>
                </div>
                -->
              </form>
            </mat-card>
          </div>
          <!--end col-md-9-->

          <div class="col-md-3">
            <mat-card>
              <mat-card-header>
                <mat-card-title>Ranking Parameters</mat-card-title>
                <mat-card-subtitle></mat-card-subtitle>
              </mat-card-header>

              <form>
                <table cellspacing="0">
                  <tr>
                    <td>
                      <mat-form-field>
                        <mat-label>Keyword field weight</mat-label>
                        <input matInput placeholder="" [(ngModel)]="keywordFieldWeight" name="keywordFieldWeight" />
                      </mat-form-field>
                    </td>
                    <td>
                      <mat-form-field>
                        <mat-label>Description field weight</mat-label>
                        <input matInput placeholder="" [(ngModel)]="descriptionFieldWeight" name="descriptionFieldWeight" />
                      </mat-form-field>
                    </td>
                  </tr>
                </table>

                <mat-form-field>
                  <mat-label>Minimum should match</mat-label>
                  <input matInput placeholder="" [(ngModel)]="minimumShouldMatch" name="minimumShouldMatch"/>
                </mat-form-field>

                <table cellspacing="0">
                  <tr>
                    <td>
                      <mat-checkbox [checked]="true" [(ngModel)]="cluster" name="cluster"> Group (use example) </mat-checkbox>
                    </td>
                    <td>
                      <mat-form-field>
                        <mat-label>No. of groups</mat-label>
                        <input matInput placeholder="" [(ngModel)]="numClusters" name="numClusters" [disabled]= cluster/>
                      </mat-form-field>
                    </td>
                  </tr>
                </table>

              </form>
            </mat-card>
          </div>
        </div>

        <!-- Propagation button -->
        <!--
        <div class="row">
          <div class="col-md-1 offset-md-11">
            <button mat-raised-button class="btn btn-warning float-right" (click)="onClickPropagateAll()">
              Propagate All
            </button>
          </div>
        </div>
        -->

        <mat-card *ngIf="ontoDataMatchingGroups?.length">
          <mat-card-header>
            <mat-card-title>Data Streams</mat-card-title>
            <mat-card-subtitle></mat-card-subtitle>
          </mat-card-header>
          <app-onto-data-group-table
            [data]="ontoDataMatchingGroups"
            (onClickPropagate)="onClickPropagateOntoDataSearchGroup($event)"
            (onClickRemove)="onClickRemoveOntoDataSearchGroup($event)"
          >
          </app-onto-data-group-table>
        </mat-card>

        <mat-card *ngIf="ontoPageExtSearchGroups?.length">
          <mat-card-header>
            <mat-card-title>Links</mat-card-title>
            <mat-card-subtitle></mat-card-subtitle>
          </mat-card-header>
          <app-onto-page-ext-group-table
            [data]="ontoPageExtSearchGroups"
            (onClickPropagate)="onClickPropagateOntoDataSearchGroup($event)"
            (onClickRemove)="onClickRemoveOntoDataSearchGroup($event)"
          >
          </app-onto-page-ext-group-table>
        </mat-card>
      </div>
    </div>

    <!--End- Card search data-->
  </div>

    <!-- set loaderId to something that is different from "master" -->
    <ngx-ui-loader></ngx-ui-loader>

  <!--End container-fluid-->
</div>
<!--End main-content-->
